const CANVAS=document.getElementById("game-canvas"),CONTEXT=CANVAS.getContext("2d"),CANVAS_BACKGROUND_COLOR="#F5F5DC",SNAKE_COLOR="#004200",SNAKE_BORDER_COLOR="#006600",APPLE_COLOR="#FF0000",APPLE_BORDER_COLOR="#820000";let foodX=0,foodY=0,snake=[{x:300,y:300}],directionX=0,directionY=0,score=0,highScore=0,gameIsOver=!1;function main(){!0!==gameIsOver&&setTimeout(()=>{growSnake(),drawEverything(),checkForSnakeEatingItself(),checkForSnakeTouchingWall(),main()},100)}function drawEverything(){CONTEXT.fillStyle="#F5F5DC",CONTEXT.fillRect(0,0,CANVAS.width,CANVAS.height),snake.forEach(drawSnakeSegment),CONTEXT.fillStyle="#FF0000",CONTEXT.strokesytle="#820000",CONTEXT.fillRect(foodX,foodY,10,10),CONTEXT.strokeRect(foodX,foodY,10,10)}function drawSnakeSegment(snakeSegment){CONTEXT.fillStyle="#004200",CONTEXT.strokestyle="#006600",CONTEXT.fillRect(snakeSegment.x,snakeSegment.y,10,10),CONTEXT.strokeRect(snakeSegment.x,snakeSegment.y,10,10)}function growSnake(){const head={x:snake[0].x+directionX,y:snake[0].y+directionY};snake.unshift(head),head.x===foodX&&head.y===foodY?(score++,document.getElementById("current-score").innerHTML=score,createRandomApple()):snake.pop()}function checkForSnakeEatingItself(){for(var i=1;i<snake.length;i++)snake[i].x===snake[0].x&&snake[i].y===snake[0].y&&(gameIsOver=!0,gameOver())}function checkForSnakeTouchingWall(){(snake[0].x<0||snake[0].x>=CANVAS.width||snake[0].y<0||snake[0].y>=CANVAS.height)&&(gameIsOver=!0,gameOver())}function changeDirection(e){const goingUp=-10===directionY,goingDown=10===directionY,goingRight=10===directionX,goingLeft=-10===directionX;"ArrowLeft"!==e||goingRight||(directionX=-10,directionY=0),"ArrowUp"!==e||goingDown||(directionX=0,directionY=-10),"ArrowRight"!==e||goingLeft||(directionX=10,directionY=0),"ArrowDown"!==e||goingUp||(directionX=0,directionY=10)}function createRandomApple(){foodX=10*Math.floor(60*Math.random()),foodY=10*Math.floor(60*Math.random()),snake.forEach(snakeSegment=>{appleIsOnSnake=snakeSegment.x===foodX&&snakeSegment.y===foodY,appleIsOnSnake&&createRandomApple()})}function gameOver(){score>highScore&&(highScore=score,localStorage.setItem("high_score",highScore),score=0,document.getElementById("current-score").innerHTML=score,alert("Congratulations!\nYou achieved a new high score!")),highScore=localStorage.getItem("high_score"),score=0,document.getElementById("current-score").innerHTML=score,document.getElementById("high-score").innerHTML=highScore,CONTEXT.fillStyle="#F5F5DC",CONTEXT.fillRect(0,0,CANVAS.width,CANVAS.height),CONTEXT.fillStyle="#006600",CONTEXT.font="30px PixelBoy",CONTEXT.fillText("Game Over!",230,300),CONTEXT.fillText("Press the spacebar to play again.",97,350)}function restartGame(){gameIsOver=!1,main()}window.addEventListener("keydown",e=>{switch(e.key){case"ArrowLeft":case"ArrowUp":case"ArrowRight":case"ArrowDown":e.preventDefault(),changeDirection(e.key);break;case" ":e.preventDefault(),restartGame(),snake=[{x:300,y:300}]}}),document.getElementById("current-score").innerHTML=score,highScore=localStorage.getItem("high_score"),document.getElementById("high-score").innerHTML=null===highScore?0:highScore,createRandomApple(),main();