let canvas=document.getElementById("game-canvas"),context=canvas.getContext("2d"),foodX=0,foodY=0,snake=[{x:300,y:300}],directionX=0,directionY=0,score=0,highScore=0,gameIsOver=!1;const CANVAS_BACKGROUND_COLOR="#F5F5DC",SNAKE_COLOR="#004200",SNAKE_BORDER_COLOR="#006600",APPLE_COLOR="#FF0000",APPLE_BORDER_COLOR="#820000";function main(){!0!==gameIsOver&&setTimeout(()=>{growSnake(),drawEverything(),checkForSnakeEatingItself(),checkForSnakeTouchingWall(),main()},100)}function drawEverything(){context.fillStyle="#F5F5DC",context.fillRect(0,0,canvas.width,canvas.height),snake.forEach(drawSnakeSegment),context.fillStyle="#FF0000",context.strokesytle="#820000",context.fillRect(foodX,foodY,10,10),context.strokeRect(foodX,foodY,10,10)}function drawSnakeSegment(snakeSegment){context.fillStyle="#004200",context.strokestyle="#006600",context.fillRect(snakeSegment.x,snakeSegment.y,10,10),context.strokeRect(snakeSegment.x,snakeSegment.y,10,10)}function growSnake(){const head={x:snake[0].x+directionX,y:snake[0].y+directionY};snake.unshift(head),head.x===foodX&&head.y===foodY?(score++,document.getElementById("current-score").innerHTML=score,createRandomApple()):snake.pop()}function checkForSnakeEatingItself(){for(var i=1;i<snake.length;i++)snake[i].x===snake[0].x&&snake[i].y===snake[0].y&&(gameIsOver=!0,gameOver())}function checkForSnakeTouchingWall(){(snake[0].x<0||snake[0].x>=canvas.width||snake[0].y<0||snake[0].y>=canvas.height)&&(gameIsOver=!0,gameOver())}function changeDirection(e){const goingUp=-10===directionY,goingDown=10===directionY,goingRight=10===directionX,goingLeft=-10===directionX;37!==e||goingRight||(directionX=-10,directionY=0),38!==e||goingDown||(directionX=0,directionY=-10),39!==e||goingLeft||(directionX=10,directionY=0),40!==e||goingUp||(directionX=0,directionY=10)}function createRandomApple(){foodX=10*Math.floor(60*Math.random()),foodY=10*Math.floor(60*Math.random()),snake.forEach(snakeSegment=>{appleIsOnSnake=snakeSegment.x===foodX&&snakeSegment.y===foodY,appleIsOnSnake&&createRandomApple()})}function gameOver(){score>highScore&&(highScore=score,localStorage.setItem("high_score",highScore),score=0,document.getElementById("current-score").innerHTML=score,alert("Congratulations!\nYou achieved a new high score!")),highScore=localStorage.getItem("high_score"),score=0,document.getElementById("current-score").innerHTML=score,document.getElementById("high-score").innerHTML=highScore,context.fillStyle="#F5F5DC",context.fillRect(0,0,canvas.width,canvas.height),context.fillStyle="#006600",context.font="30px PixelBoy",context.fillText("Game Over!",230,300),context.fillText("Press the spacebar to play again.",97,350)}function restartGame(){gameIsOver=!1,main()}window.addEventListener("keydown",e=>{switch(e.keyCode){case 37:case 38:case 39:case 40:e.preventDefault(),changeDirection(e.keyCode);break;case 32:e.preventDefault(),restartGame(),snake=[{x:300,y:300}]}}),document.getElementById("current-score").innerHTML=score,highScore=localStorage.getItem("high_score"),document.getElementById("high-score").innerHTML=null===highScore?0:highScore,createRandomApple(),main();